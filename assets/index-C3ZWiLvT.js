const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Overview-BEpEdpux.js","assets/vendor-_e7UF12I.js","assets/appwrite-DjGSp9AC.js","assets/Overview-DVCQcoda.css","assets/AdminRequests-jKh0T7vc.js","assets/AdminRequests-nRBaaNcp.css","assets/AgentManagement-CQoBrtPz.js","assets/AgentManagement-BuKfg1yz.css","assets/TimeLog-B6RgvuBV.js","assets/TimeLog-Bll2n9zO.css"])))=>i.map(i=>d[i]);
import{r as ie,c as Le,o as l,a as u,b as e,d as f,e as F,f as Ae,w as be,g as O,u as b,n as re,h as C,t as y,F as z,i as H,j as he,k as $e,l as se,v as Ce,m as ce,p as M,q as Q,s as qe,x as Oe,y as Te,z as Ee}from"./vendor-_e7UF12I.js";import{C as Pe,D as Ne,A as Re,Q as D,I as Me}from"./appwrite-DjGSp9AC.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))m(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&m(r)}).observe(document,{childList:!0,subtree:!0});function n(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function m(t){if(t.ep)return;t.ep=!0;const o=n(t);fetch(t.href,o)}})();const xe={__name:"App",setup(d){return(s,n)=>{const m=ie("router-view");return l(),Le(m)}}},Ue="modulepreload",Fe=function(d){return"/"+d},ue={},te=function(s,n,m){let t=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),i=(r==null?void 0:r.nonce)||(r==null?void 0:r.getAttribute("nonce"));t=Promise.allSettled(n.map(p=>{if(p=Fe(p),p in ue)return;ue[p]=!0;const w=p.endsWith(".css"),B=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${B}`))return;const g=document.createElement("link");if(g.rel=w?"stylesheet":Ue,w||(g.as="script"),g.crossOrigin="",g.href=p,i&&g.setAttribute("nonce",i),document.head.appendChild(g),w)return new Promise((I,E)=>{g.addEventListener("load",I),g.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${p}`)))})}))}function o(r){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=r,window.dispatchEvent(i),!i.defaultPrevented)throw r}return t.then(r=>{for(const i of r||[])i.status==="rejected"&&o(i.reason);return s().catch(o)})},Ve="/static/pepe-okay-lucha.jpg",je=()=>"https://fra.cloud.appwrite.io/v1",Ye=()=>"6846140e000a316ba80b",ye=new Pe().setEndpoint(je()).setProject(Ye()),V=new Re(ye),q=new Ne(ye),K=(d,s)=>{const n=d.__vccOpts||d;for(const[m,t]of s)n[m]=t;return n},We={class:"login-bg"},ze={__name:"UserLogin",setup(d){async function s(){try{const n=window.location.origin,m=`${n}/agent`,t=`${n}/`;await V.createOAuth2Session("google",m,t)}catch(n){console.error("Login failed:",n),alert("Login failed. Please try again.")}}return(n,m)=>(l(),u("div",We,[e("div",{class:"login-container"},[m[0]||(m[0]=e("img",{src:Ve,alt:"Welcome Icon",class:"login-icon"},null,-1)),m[1]||(m[1]=e("h1",{class:"login-title"},"Welcome to the Agent Portal",-1)),e("button",{class:"login-google-btn",onClick:s}," Login with Google ")])]))}},Ke=K(ze,[["__scopeId","data-v-dbd37b70"]]),_e="/static/three-dots.svg",Ge="/static/pepe-clocked.jpg",He="/static/small-pepe-circle.jpg",Qe="/static/agent.svg",Ze="/static/key.svg",de="/static/clock.svg",me="/static/home.svg",ve="/static/arrow-door.svg",ge="/static/donuts.svg",we="684639c3000fbbd515ea",Se="68463a24000779b721a1";async function le(){return(await V.get()).$id}async function U(d,s){const n=new Date().toISOString().slice(0,10);return q.createDocument(we,Se,"unique()",{user_Id:d,Status:s,date:n,timestamp:new Date().toISOString()})}async function Be(d){const s=new Date().toISOString().slice(0,10);return(await q.listDocuments(we,Se,[D.equal("user_Id",d),D.equal("date",s)])).documents}const pe={"Short Break":15,"Bathroom Break":15,Lunch:45};async function ne(d){const s=await Be(d),n=[],m=[{start:"Started Short Break",end:"Back from Short Break",label:"Short Break"},{start:"Started Bathroom Break",end:"Back from Bathroom Break",label:"Bathroom Break"},{start:"Started Lunch",end:"Back from Lunch",label:"Lunch"}];for(const{start:t,end:o,label:r}of m){let i=0;for(;i<s.length;)if(s[i].Status===t){const p=new Date(s[i].timestamp);let w=i+1;for(;w<s.length&&s[w].Status!==o;)w++;if(w<s.length){const B=new Date(s[w].timestamp),g=(B-p)/6e4;g>pe[r]&&n.push({type:r,overBy:Math.max(1,Math.round(g-pe[r])),start:p,end:B}),i=w+1}else i++}else i++}return n}function Je(){"Notification"in window&&Notification.permission!=="granted"&&Notification.requestPermission()}const ke=new Set;function oe(d,s){const n=`${d}:${s}`;!ke.has(n)&&"Notification"in window&&Notification.permission==="granted"&&(new Notification(d,{body:s}),ke.add(n))}const Xe="684639c3000fbbd515ea",et="684654f10018b0311641";async function ae(d,s,n){const m=new Date().toISOString().slice(0,10);return q.createDocument(Xe,et,"unique()",{user_Id:d,breakType:s,overBy:n,timestamp:new Date().toISOString(),date:m})}function fe(d){const s=f("Not clocked in"),n=f("clockin"),m=f(!1),t=f(0),o=f(0),r=f([]),i=f("");F(()=>{le().then(k=>{i.value=k}),Je()});function p(k){const c=new Date;r.value.unshift({action:k,time:c.toLocaleTimeString()})}async function w(){const k=new Date().toISOString().slice(0,10);try{if(i.value&&(await q.listDocuments("684639c3000fbbd515ea","68463a24000779b721a1",[D.equal("user_Id",i.value),D.equal("date",k),D.equal("Status","Clocked in")])).documents.length>0){window.alert("You have already clocked in today. Please contact an admin if this is an error.");return}}catch(c){console.error("Error checking clock status:",c)}s.value="Clocked in",n.value="main",p("Clocked in"),i.value&&await U(i.value,"Clocked in")}async function B(){if(!m.value){if(d.value<5&&!window.confirm("Warning: Fewer than 5 agents are active. Are you sure you want to take a break?"))return;s.value="On Lunch",n.value="backlunch",m.value=!0,p("Started Lunch"),i.value&&await U(i.value,"Started Lunch")}}async function g(){if(s.value="Clocked in",n.value="main",p("Back from Lunch"),i.value){await U(i.value,"Back from Lunch");const c=(await ne(i.value)).find(A=>A.type==="Lunch");c&&c.overBy>0&&(window.alert(`You exceeded your lunch break by ${c.overBy} minutes. This has been reported to your admin.`),oe("Lunch Break Overage",`You exceeded your lunch break by ${c.overBy} minutes.`),await ae(i.value,"Lunch",c.overBy))}}async function I(){if(t.value<2){if(d.value<5&&!window.confirm("Warning: Fewer than 5 agents are active. Are you sure you want to take a break?"))return;s.value="On Short Break",n.value="backshortbreak",t.value++,p("Started Short Break"),i.value&&await U(i.value,"Started Short Break")}}async function E(){if(s.value="Clocked in",n.value="main",p("Back from Short Break"),i.value){await U(i.value,"Back from Short Break");const c=(await ne(i.value)).find(A=>A.type==="Short Break");c&&c.overBy>0&&(window.alert(`You exceeded your short break by ${c.overBy} minutes. This has been reported to your admin.`),oe("Short Break Overage",`You exceeded your short break by ${c.overBy} minutes.`),await ae(i.value,"Short Break",c.overBy))}}async function L(){if(o.value<5){if(d.value<5&&!window.confirm("Warning: Fewer than 5 agents are active. Are you sure you want to take a break?"))return;s.value="On Bathroom Break",n.value="backbathroombreak",o.value++,p("Started Bathroom Break"),i.value&&await U(i.value,"Started Bathroom Break")}}async function j(){if(s.value="Clocked in",n.value="main",p("Back from Bathroom Break"),i.value){await U(i.value,"Back from Bathroom Break");const c=(await ne(i.value)).find(A=>A.type==="Bathroom Break");c&&c.overBy>0&&(window.alert(`You exceeded your bathroom break by ${c.overBy} minutes. This has been reported to your admin.`),oe("Bathroom Break Overage",`You exceeded your bathroom break by ${c.overBy} minutes.`),await ae(i.value,"Bathroom Break",c.overBy))}}async function R(){const k=new Date().toISOString().slice(0,10);try{if(i.value&&(await q.listDocuments("684639c3000fbbd515ea","68463a24000779b721a1",[D.equal("user_Id",i.value),D.equal("date",k),D.equal("Status","Clocked out")])).documents.length>0){window.alert("You have already clocked out today. Please contact an admin if this is an error.");return}}catch(c){console.error("Error checking clock status:",c)}confirm("Are you sure you want to clock out?")&&(s.value="Clocked out",n.value="",p("Clocked out"),i.value&&await U(i.value,"Clocked out"))}async function T(k){if(!k)return[];const c=new Date().toISOString().slice(0,10);try{return(await q.listDocuments("684639c3000fbbd515ea","68463a24000779b721a1",[D.equal("user_Id",k),D.equal("date",c),D.orderDesc("timestamp")])).documents.map(_=>({action:_.Status,time:new Date(_.timestamp).toLocaleTimeString()}))}catch(A){return console.error("Error fetching agent log:",A),[]}}return{status:s,step:n,lunchUsed:m,shortBreaksUsed:t,bathroomBreaksUsed:o,log:r,clockIn:w,startLunch:B,backFromLunch:g,startShortBreak:I,backFromShortBreak:E,startBathroomBreak:L,backFromBathroomBreak:j,clockOut:R,getAgentLog:T}}function tt(){const d=f({clockedIn:!1,lastStatus:"",lastActivity:null,loading:!0}),s=f("");async function n(){d.value.loading=!0,s.value=await le();const m=await Be(s.value);m.sort((i,p)=>new Date(p.timestamp)-new Date(i.timestamp));const t=m[0];d.value.lastActivity=t,d.value.lastStatus=t?t.Status:"";let o="clockin",r=!1;if(t)switch(t.Status){case"Clocked in":case"Back from Lunch":case"Back from Short Break":case"Back from Bathroom Break":o="main",r=!0;break;case"Started Lunch":o="backlunch",r=!0;break;case"Started Short Break":o="backshortbreak",r=!0;break;case"Started Bathroom Break":o="backbathroombreak",r=!0;break;case"Clocked out":default:o="clockin",r=!1;break}d.value.clockedIn=r,d.value.uiStep=o,d.value.loading=!1}return F(()=>{n()}),{sessionState:d,checkSessionState:n,userId:s}}const Z="684639c3000fbbd515ea",J="68465330002c380c2975";function st(){const d=f([]),s=f(!0);async function n(){s.value=!0;try{const o=await q.listDocuments(Z,J);d.value=o.documents}catch{d.value=[]}s.value=!1}async function m(){const o=await V.get();return(await q.listDocuments(Z,J,[D.equal("user_Id",o.$id)])).documents[0]||null}async function t(o,r,i){const p=await q.listDocuments(Z,J,[D.equal("user_Id",o)]);return p.documents.length>0?q.updateDocument(Z,J,p.documents[0].$id,{displayName:r,approved:i}):q.createDocument(Z,J,"unique()",{user_Id:o,displayName:r,approved:i})}return{profiles:d,loading:s,fetchProfiles:n,getCurrentUserProfile:m,setDisplayName:t}}const Ie=["mijaelkuma@gmail.com","numusmike@gmail.com"],nt={class:"agent-bg"},ot={class:"agent-main"},at={key:0,class:"agent-spinner-wrap"},it={class:"ticker-text"},rt={class:"agent-clock",id:"clock"},lt={class:"agent-status"},ct={key:2,class:"admin-portal-btn-wrap"},ut={key:3,class:"agent-buttons-grid"},dt=["disabled"],mt={key:4,class:"session-complete-msg"},vt={class:"agent-log"},gt={class:"log-time"},pt={key:0},kt={class:"log-action"},ft={key:1},bt={key:0,class:"log-expand-btn-wrap"},ht={__name:"AgentDashboard",setup(d){const s=he(),n=f(!1),m=f(!1),t=f(0),{getCurrentUserProfile:o}=st(),r=f("");F(async()=>{const $=await o();r.value=$&&$.approved?$.displayName:"";try{const a=await V.get();m.value=Ie.includes(a.email)}catch{}});function i(){s.push("/admin")}const{sessionState:p,checkSessionState:w}=tt(),B=Ae(()=>t.value<5?"ticker-red":t.value<=8?"ticker-yellow":"ticker-green");async function g(){const $=new Date().toISOString().slice(0,10);try{const a=await q.listDocuments("684639c3000fbbd515ea","68463a24000779b721a1",[D.equal("date",$)]),v=new Set;[...a.documents].sort((h,S)=>new Date(h.timestamp)-new Date(S.timestamp)).forEach(h=>{const S=h.user_Id,P=h.Status;P==="Clocked in"?v.add(S):P==="Clocked out"||P.includes("Started")&&(P.includes("Break")||P.includes("Lunch"))?v.delete(S):P.includes("Back from")&&(P.includes("Break")||P.includes("Lunch"))&&v.add(S)}),t.value=v.size}catch{t.value=0}}const I=f("--:--:--"),{status:E,step:L,lunchUsed:j,shortBreaksUsed:R,bathroomBreaksUsed:T,log:k,clockIn:c,startLunch:A,backFromLunch:_,startShortBreak:Y,backFromShortBreak:X,startBathroomBreak:x,backFromBathroomBreak:W,clockOut:G}=fe(t);F(()=>{g(),setInterval(g,1e4),setInterval(()=>{const $=new Date;I.value=$.toLocaleTimeString()},1e3)}),be(()=>p.value.uiStep,$=>{switch($){case"main":E.value="Clocked in",L.value="main";break;case"backlunch":E.value="On Lunch",L.value="backlunch";break;case"backshortbreak":E.value="On Short Break",L.value="backshortbreak";break;case"backbathroombreak":E.value="On Bathroom Break",L.value="backbathroombreak";break;case"clockin":default:E.value="Not clocked in",L.value="clockin";break}},{immediate:!0});async function N(){await w()}async function ee(){try{const $=await V.get(),{getAgentLog:a}=fe(t),v=await a($.$id);v&&v.length>0&&(k.value=v)}catch($){console.error("Failed to update activity log:",$)}}return F(()=>{g(),ee(),setInterval(g,3e5),setInterval(ee,3e5),setInterval(()=>{const $=new Date;I.value=$.toLocaleTimeString()},1e3)}),($,a)=>(l(),u("div",nt,[e("div",ot,[a[26]||(a[26]=e("div",{class:"agent-logo-wrap"},[e("img",{src:Ge,alt:"Agent Logo",class:"agent-logo"})],-1)),b(p).loading?(l(),u("div",at,a[9]||(a[9]=[e("img",{src:He,alt:"Loading...",class:"agent-spinner"},null,-1)]))):(l(),u("div",{key:1,class:re(["agent-ticker",B.value])},[a[11]||(a[11]=e("img",{src:Qe,alt:"Active Agents",class:"ticker-icon"},null,-1)),e("span",it,[a[10]||(a[10]=C("Active Agents: ")),e("b",null,y(t.value),1)])],2)),e("div",rt,y(I.value),1),e("div",lt,[a[12]||(a[12]=C("Status: ")),e("b",null,y(b(E)),1)]),m.value?(l(),u("div",ct,[e("button",{onClick:i,class:"admin-portal-btn"},a[13]||(a[13]=[e("img",{src:Ze,alt:"Admin Portal"},null,-1),C(" Admin Portal ")]))])):O("",!0),b(p).lastStatus!=="Clocked out"?(l(),u("div",ut,[b(L)==="clockin"?(l(),u("button",{key:0,class:"agent-btn agent-btn-blue",disabled:b(p).clockedIn||b(p).loading,onClick:a[0]||(a[0]=v=>b(c)().then(N))},a[14]||(a[14]=[e("img",{src:de,class:"btn-icon"},null,-1),C(" Clock In ")]),8,dt)):O("",!0),b(L)==="main"?(l(),u(z,{key:1},[b(j)?O("",!0):(l(),u("button",{key:0,class:"agent-btn agent-btn-orange",onClick:a[1]||(a[1]=v=>b(A)().then(N))},a[15]||(a[15]=[e("img",{src:me,class:"btn-icon"},null,-1),C(" Lunch (45 min) ")]))),b(R)<2?(l(),u("button",{key:1,class:"agent-btn agent-btn-gold",onClick:a[2]||(a[2]=v=>b(Y)().then(N))},a[16]||(a[16]=[e("img",{src:ve,class:"btn-icon"},null,-1),C(" Short Break (15 min) ")]))):O("",!0),b(T)<5?(l(),u("button",{key:2,class:"agent-btn agent-btn-pink",onClick:a[3]||(a[3]=v=>b(x)().then(N))},a[17]||(a[17]=[e("img",{src:ge,class:"btn-icon"},null,-1),C(" Bathroom Break (15 min) ")]))):O("",!0),e("button",{class:"agent-btn agent-btn-red",onClick:a[4]||(a[4]=v=>b(G)().then(N))},a[18]||(a[18]=[e("img",{src:de,class:"btn-icon"},null,-1),C(" Clock Out ")]))],64)):O("",!0),b(L)==="backlunch"?(l(),u("button",{key:2,class:"agent-btn agent-btn-orange",onClick:a[5]||(a[5]=v=>b(_)().then(N))},a[19]||(a[19]=[e("img",{src:me,class:"btn-icon"},null,-1),C(" Back from Lunch ")]))):O("",!0),b(L)==="backshortbreak"?(l(),u("button",{key:3,class:"agent-btn agent-btn-gold",onClick:a[6]||(a[6]=v=>b(X)().then(N))},a[20]||(a[20]=[e("img",{src:ve,class:"btn-icon"},null,-1),C(" Back from Break ")]))):O("",!0),b(L)==="backbathroombreak"?(l(),u("button",{key:4,class:"agent-btn agent-btn-pink",onClick:a[7]||(a[7]=v=>b(W)().then(N))},a[21]||(a[21]=[e("img",{src:ge,class:"btn-icon"},null,-1),C(" Back from Break ")]))):O("",!0)])):(l(),u("div",mt,a[22]||(a[22]=[e("div",{class:"session-complete-title"},"Your session is complete for today.",-1),e("div",{class:"session-complete-sub"},"If you believe this is an error, please contact your admin.",-1)]))),e("div",vt,[a[25]||(a[25]=e("h3",null,"My Activity Log",-1)),e("ul",null,[(l(!0),u(z,null,H(n.value?b(k):b(k).slice(0,2),v=>(l(),u("li",{key:v.time},[e("span",gt,y(v.time),1),r.value?(l(),u("span",pt,[a[23]||(a[23]=C(" — ")),e("span",kt,y(r.value),1)])):(l(),u("span",ft,a[24]||(a[24]=[C(" — "),e("span",{class:"log-action"},"You",-1)]))),e("span",null," — "+y(v.action),1)]))),128))]),b(k).length>2?(l(),u("div",bt,[e("button",{class:"log-expand-btn",onClick:a[8]||(a[8]=v=>n.value=!n.value)},y(n.value?"Show less":"Show more"),1)])):O("",!0)])])]))}},yt=K(ht,[["__scopeId","data-v-e10ab991"]]),_t="/static/flag.svg",wt="/static/calendar.svg",St="/static/link.svg",Bt="/static/out.svg",It={key:0,class:"popup-overlay"},Dt={class:"popup-content"},Lt={class:"form-group"},At={class:"form-group"},$t=["disabled"],Ct={class:"form-group"},qt={__name:"TimeRequestPopup",props:{visible:Boolean,userId:String},emits:["close","requestSubmitted"],setup(d,{emit:s}){const n=d,m=s,t=f("I clicked a button"),o=f(new Date().toISOString().slice(0,10)),r=f("");be(()=>n.visible,B=>{B&&(o.value=new Date().toISOString().slice(0,10))});const i=async()=>{if(n.userId)try{await q.createDocument("684639c3000fbbd515ea","68465b72001c6de6395f",Me.unique(),{user_Id:n.userId,request_type:t.value,request_date:o.value,request_message:r.value,timestamp:new Date().toISOString()}),m("requestSubmitted"),p(),w()}catch(B){console.error("Failed to submit request:",B),alert("Failed to submit request. Please try again.")}},p=()=>{t.value="I clicked a button",o.value=new Date().toISOString().slice(0,10),r.value=""},w=()=>{m("close")};return(B,g)=>d.visible?(l(),u("div",It,[e("div",Dt,[g[8]||(g[8]=e("h2",null,"Request Time Change/Time Off",-1)),e("form",{onSubmit:$e(i,["prevent"])},[e("div",Lt,[g[4]||(g[4]=e("label",{for:"requestType"},"Request Type",-1)),se(e("select",{"onUpdate:modelValue":g[0]||(g[0]=I=>t.value=I),id:"requestType",class:"styled-select",required:""},g[3]||(g[3]=[e("option",{value:"i accidentally clicked a button"},"I accidentally clicked a button",-1),e("option",{value:"I clocked out by accident"},"I clocked out by accident",-1),e("option",{value:"I need help (tech support)"},"I need help (tech support)",-1),e("option",{value:"time off"},"Time Off",-1)]),512),[[Ce,t.value]])]),e("div",At,[g[5]||(g[5]=e("label",{for:"requestDate"},"Request Date",-1)),se(e("input",{type:"date",id:"requestDate","onUpdate:modelValue":g[1]||(g[1]=I=>o.value=I),disabled:t.value!=="time off",required:""},null,8,$t),[[ce,o.value]])]),e("div",Ct,[g[6]||(g[6]=e("label",{for:"requestMessage"},"Comments",-1)),se(e("textarea",{id:"requestMessage","onUpdate:modelValue":g[2]||(g[2]=I=>r.value=I),maxlength:"100",placeholder:"Enter your comments here...",required:""},null,512),[[ce,r.value]])]),e("div",{class:"button-group"},[g[7]||(g[7]=e("button",{type:"submit",class:"primary-button"},"Submit Request",-1)),e("button",{type:"button",class:"secondary-button",onClick:w},"Cancel")])],32)])])):O("",!0)}},Ot=K(qt,[["__scopeId","data-v-18e512fb"]]);function Tt(){const d=f([]),s=f(0),n=f(!0),m=async()=>{try{const t=await le(),o=await q.listDocuments("684639c3000fbbd515ea","684654f10018b0311641",[D.equal("user_Id",t)]);d.value=o.documents,s.value=o.documents.length}catch(t){console.error("Failed to fetch admin messages:",t)}finally{n.value=!1}};return F(m),{messages:d,pendingMessages:s,loading:n,fetchMessages:m}}const Et={key:0,class:"admin-messages"},Pt={key:0},Nt={key:1},Rt={key:2},Mt={key:1,class:"links"},xt={__name:"AppSidebar",props:{open:Boolean},setup(d){const s=he(),n=f(!1),m=f(""),t=f(!1),o=f(!1),{messages:r,pendingMessages:i,loading:p,fetchMessages:w}=Tt();F(async()=>{try{const R=await V.get();m.value=R.$id,w()}catch{s.push("/")}});const B=()=>{n.value=!0},g=()=>{n.value=!1},I=()=>{alert("Your request has been submitted successfully.")},E=()=>{t.value=!t.value},L=()=>{o.value=!o.value},j=async()=>{try{await V.deleteSession("current"),s.push("/")}catch(R){console.error("Logout failed",R)}};return(R,T)=>(l(),u("div",{class:re(["sidebar",{"sidebar-open":d.open}])},[e("div",{class:"sidebar-section",onClick:E},[T[0]||(T[0]=e("img",{src:_t,alt:"Admin Messages"},null,-1)),e("span",null,"Admin Messages ("+y(b(i))+")",1)]),t.value?(l(),u("div",Et,[b(p)?(l(),u("div",Pt,"Loading...")):b(r).length===0?(l(),u("div",Nt,"No new messages.")):(l(),u("ul",Rt,[(l(!0),u(z,null,H(b(r),k=>(l(),u("li",{key:k.$id},y(k.breakType)+" over by "+y(k.overBy)+" minutes on "+y(new Date(k.timestamp).toLocaleDateString()),1))),128))]))])):O("",!0),e("div",{class:"sidebar-section",onClick:B},T[1]||(T[1]=[e("img",{src:wt,alt:"Time Modification Requests"},null,-1),e("span",null,"Time Modification Requests",-1)])),e("div",{class:"sidebar-section",onClick:L},T[2]||(T[2]=[e("img",{src:St,alt:"Links"},null,-1),e("span",null,"Links",-1)])),o.value?(l(),u("div",Mt,T[3]||(T[3]=[e("ul",null,[e("li",null,[e("a",{href:"https://login.forthcrm.com/login.php",target:"_blank"},"Forth")]),e("li",null,[e("a",{href:"https://respro.motiondebt.com/users/sign_in",target:"_blank"},"Motion")]),e("li",null,[e("a",{href:"https://elitelegalpractice.my.salesforce.com/",target:"_blank"},"Salesforce")])],-1)]))):O("",!0),M(Ot,{visible:n.value,userId:m.value,onClose:g,onRequestSubmitted:I},null,8,["visible","userId"]),e("div",{class:"logout-icon",onClick:j},T[4]||(T[4]=[e("img",{src:Bt,alt:"Logout"},null,-1)]))],2))}},Ut=K(xt,[["__scopeId","data-v-217f039c"]]),Ft={class:"agent-layout-bg"},Vt={class:"agent-layout-main"},jt={__name:"AgentLayout",setup(d){const s=f(!1);return(n,m)=>(l(),u("div",Ft,[e("div",Vt,[M(yt)]),M(Ut,{open:s.value},null,8,["open"]),e("button",{class:"sidebar-toggle",onClick:m[0]||(m[0]=t=>s.value=!s.value)},m[1]||(m[1]=[e("img",{src:_e,alt:"Sidebar"},null,-1)]))]))}},Yt=K(jt,[["__scopeId","data-v-cc00672d"]]),Wt="/static/pepe-admin.jpg",zt={key:0},Kt={class:"home-link"},Gt={__name:"AdminSidebar",setup(d){const s=f(!1),n=()=>{s.value=!s.value};return(m,t)=>{const o=ie("router-link");return l(),u("div",{class:re(["admin-sidebar",{collapsed:s.value}])},[e("button",{onClick:n,class:"toggle-btn"},t[0]||(t[0]=[e("img",{src:_e,alt:"Toggle Sidebar"},null,-1)])),s.value?O("",!0):(l(),u("ul",zt,[e("li",null,[M(o,{to:"/admin"},{default:Q(()=>t[1]||(t[1]=[C("Overview")])),_:1})]),e("li",null,[M(o,{to:"/admin/requests"},{default:Q(()=>t[2]||(t[2]=[C("Requests")])),_:1})]),e("li",null,[M(o,{to:"/admin/agent-management"},{default:Q(()=>t[3]||(t[3]=[C("Agent Management")])),_:1})]),e("li",null,[M(o,{to:"/admin/time-log"},{default:Q(()=>t[4]||(t[4]=[C("Time Log")])),_:1})]),e("li",Kt,[M(o,{to:"/agent"},{default:Q(()=>t[5]||(t[5]=[C("Return to Agent")])),_:1})])]))],2)}}},Ht=K(Gt,[["__scopeId","data-v-4388e9da"]]),Qt={class:"admin-layout"},Zt={class:"admin-bg"},Jt={class:"admin-main"},Xt={key:0},es={class:"admin-tickers"},ts={class:"ticker"},ss={class:"ticker-value"},ns={class:"ticker"},os={class:"ticker-value"},as={class:"ticker"},is={class:"ticker-value"},rs={class:"active-agents-list"},ls={key:0,class:"no-agents"},cs={key:1,class:"agents-list"},us={class:"agent-name"},ds={class:"agent-status"},ms={class:"agent-time"},vs={class:"admin-concerns"},gs={class:"concerns-content"},ps={class:"concern-section"},ks={key:0,class:"no-concerns"},fs={key:1,class:"concerns-list"},bs={class:"concern-user"},hs={class:"concern-detail"},ys={class:"concern-time"},_s={class:"concern-section"},ws={key:0,class:"no-concerns"},Ss={key:1,class:"concerns-list"},Bs={class:"concern-user"},Is={class:"concern-detail"},Ds={class:"admin-activity-log"},Ls={class:"toggle-icon"},As={key:0},$s={key:0,class:"no-activities"},Cs={key:1,class:"activity-list"},qs={class:"activity-time"},Os={class:"activity-user"},Ts={class:"activity-status"},Es={key:2,class:"show-more"},Ps={__name:"AdminInterface",setup(d){const s=f(0),n=f(0),m=f([]),t=f(0),o=f([]),r=f([]),i=f([]),p=f([]),w=f({}),B=f(!1),g=f(10);let I=null;const E=async()=>{try{const k=new Date().toISOString().slice(0,10);let c;try{c=await q.listDocuments("684639c3000fbbd515ea","68463a24000779b721a1",[D.equal("date",k),D.orderDesc("timestamp")])}catch{c=await q.listDocuments("684639c3000fbbd515ea","68463a24000779b721a1",[D.greaterThanEqual("timestamp",k+"T00:00:00.000Z"),D.lessThan("timestamp",k+"T23:59:59.999Z"),D.orderDesc("timestamp")])}const A=c.documents;p.value=A,(await q.listDocuments("684639c3000fbbd515ea","68465330002c380c2975")).documents.forEach(v=>{v.user_Id&&v.displayName&&(w.value[v.user_Id]=v.displayName)});const Y=new Set,X=[],x={},W={};[...A].sort((v,h)=>new Date(v.timestamp)-new Date(h.timestamp)).forEach(v=>{const h=v.user_Id,S=v.Status,P=v.timestamp;S==="Clocked in"?(Y.add(h),x[h]="Working",W[h]=P):S==="Clocked out"?(Y.delete(h),delete x[h],delete W[h]):S.includes("Started")&&(S.includes("Break")||S.includes("Lunch"))?(Y.delete(h),x[h]=S.replace("Started ","On "),W[h]=P):S.includes("Back from")&&(S.includes("Break")||S.includes("Lunch"))&&(Y.add(h),x[h]="Working",W[h]=P)});for(const v of Object.keys(x))X.push({userId:v,status:x[v],since:W[v]});n.value=Y.size,m.value=X;let G;try{G=await q.listDocuments("684639c3000fbbd515ea","684654f10018b0311641")}catch(v){console.error("Error fetching violations:",v),G={documents:[],total:0}}t.value=G.total,o.value=G.documents;const N=new Date(k);N.setHours(8,10,0);const ee=A.filter(v=>{if(v.Status==="Clocked in"){const h=new Date(v.timestamp);return h>N&&h.toISOString().slice(0,10)===k}return!1}),$={};[...A].sort((v,h)=>new Date(v.timestamp)-new Date(h.timestamp)).forEach(v=>{const h=v.user_Id,S=v.Status;S.includes("Started")&&(S.includes("Break")||S.includes("Lunch"))?$[h]=!0:S.includes("Back from")&&(S.includes("Break")||S.includes("Lunch"))&&($[h]=!1)});const a=[...new Set(A.map(v=>v.user_Id))];s.value=a.length,r.value=ee,i.value=A}catch(k){console.error("Failed to fetch admin data:",k)}};function L(k){return w.value[k]||k}function j(){B.value=!B.value}function R(){g.value+=20}const T=()=>{I&&(clearInterval(I),I=null)};return F(async()=>{try{await E(),I=setInterval(async()=>{try{await E()}catch(k){console.error("Error in polling interval:",k)}},3e5)}catch(k){console.error("Error in onMounted:",k)}}),qe(T),(k,c)=>{const A=ie("router-view");return l(),u("div",Qt,[M(Ht),e("div",Zt,[e("div",Jt,[c[8]||(c[8]=e("div",{class:"admin-header"},[e("img",{src:Wt,alt:"Admin Icon",class:"admin-icon"}),e("h1",{class:"admin-title"},"Admin Dashboard")],-1)),k.$route.path==="/admin"?(l(),u("div",Xt,[e("div",es,[e("div",ts,[e("div",ss,y(s.value),1),c[0]||(c[0]=e("div",{class:"ticker-label"},"Agents Logged In Today",-1))]),e("div",ns,[e("div",os,y(n.value),1),c[1]||(c[1]=e("div",{class:"ticker-label"},"Active",-1))]),e("div",as,[e("div",is,y(t.value),1),c[2]||(c[2]=e("div",{class:"ticker-label"},"Break Violations",-1))])]),e("div",rs,[c[3]||(c[3]=e("h3",null,"Active Agents",-1)),m.value.length===0?(l(),u("div",ls," No agents currently active ")):(l(),u("ul",cs,[(l(!0),u(z,null,H(m.value,_=>(l(),u("li",{key:_.userId,class:"agent-item"},[e("span",us,y(L(_.userId)),1),e("span",ds,y(_.status),1),e("span",ms,"Since "+y(new Date(_.since).toLocaleTimeString()),1)]))),128))]))]),e("div",vs,[c[6]||(c[6]=e("div",{class:"concerns-header"},[e("h3",null,"Key Areas of Concern")],-1)),e("div",gs,[e("div",ps,[c[4]||(c[4]=e("h4",null,"Break Violations",-1)),o.value.length===0?(l(),u("div",ks," No break violations today ")):(l(),u("ul",fs,[(l(!0),u(z,null,H(o.value,_=>(l(),u("li",{key:_.$id,class:"concern-item"},[e("span",bs,y(L(_.user_Id)),1),e("span",hs,y(_.breakType)+" over by "+y(_.overBy)+" minutes",1),e("span",ys,y(new Date(_.timestamp).toLocaleTimeString()),1)]))),128))]))]),e("div",_s,[c[5]||(c[5]=e("h4",null,"Late Clock-ins (After 8:10 AM)",-1)),r.value.length===0?(l(),u("div",ws," No late clock-ins today ")):(l(),u("ul",Ss,[(l(!0),u(z,null,H(r.value,_=>(l(),u("li",{key:_.$id,class:"concern-item"},[e("span",Bs,y(L(_.user_Id)),1),e("span",Is,"Clocked in at "+y(new Date(_.timestamp).toLocaleTimeString()),1)]))),128))]))])])]),e("div",Ds,[e("div",{class:"activity-header",onClick:j},[c[7]||(c[7]=e("h3",null,"Today's Activity Log",-1)),e("span",Ls,y(B.value?"▼":"►"),1)]),B.value?(l(),u("div",As,[p.value.length===0?(l(),u("div",$s," No activities recorded today ")):(l(),u("ul",Cs,[(l(!0),u(z,null,H(p.value.slice(0,B.value?20:10),_=>(l(),u("li",{key:_.$id,class:"activity-item"},[e("span",qs,y(new Date(_.timestamp).toLocaleTimeString()),1),e("span",Os,y(L(_.user_Id)),1),e("span",Ts,y(_.Status),1)]))),128))])),p.value.length>20?(l(),u("div",Es,[e("button",{onClick:R},"Show more")])):O("",!0)])):O("",!0)])])):O("",!0),M(A)])])])}}},Ns=K(Ps,[["__scopeId","data-v-c93bea2d"]]),Rs=[{path:"/",component:Ke},{path:"/agent",component:Yt,meta:{requiresAuth:!0}},{path:"/admin",component:Ns,meta:{requiresAuth:!0,requiresAdmin:!0},children:[{path:"",component:()=>te(()=>import("./Overview-BEpEdpux.js"),__vite__mapDeps([0,1,2,3]))},{path:"requests",component:()=>te(()=>import("./AdminRequests-jKh0T7vc.js"),__vite__mapDeps([4,2,1,5]))},{path:"agent-management",component:()=>te(()=>import("./AgentManagement-CQoBrtPz.js"),__vite__mapDeps([6,1,2,7]))},{path:"time-log",component:()=>te(()=>import("./TimeLog-B6RgvuBV.js"),__vite__mapDeps([8,1,2,9]))}]}],De=Oe({history:Te(),routes:Rs});De.beforeEach(async(d,s,n)=>{const m=d.matched.some(r=>r.meta.requiresAuth),t=d.matched.some(r=>r.meta.requiresAdmin);let o=null;try{o=await V.get()}catch{}m&&!o||t&&!Ie.includes(o==null?void 0:o.email)?n("/"):n()});Ee(xe).use(De).mount("#app");export{K as _,q as d};
//# sourceMappingURL=index-C3ZWiLvT.js.map
